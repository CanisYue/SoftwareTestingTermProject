Data race on field org.apache.lucene.store.RAMFile.length:
    Read in thread 31 holding lock Monitor@292061095
      > at org.apache.lucene.store.MockRAMDirectory.getRecomputedActualSizeInBytes(MockRAMDirectory.java:295)
        - locked Monitor@292061095 at org.apache.lucene.store.MockRAMDirectory.getRecomputedActualSizeInBytes(MockRAMDirectory.java:n/a)
        at org.apache.lucene.store.MockRAMOutputStream.close(MockRAMOutputStream.java:47)
        at org.apache.lucene.index.FieldInfos.write(FieldInfos.java:311)
        at org.apache.lucene.index.SegmentMerger.mergeFields(SegmentMerger.java:317)
        at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:153)
        at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:5112)
        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4675)
        at org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:235)
        at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:291)
    Thread 31 created by thread 1
        at org.apache.lucene.index.ConcurrentMergeScheduler.merge(ConcurrentMergeScheduler.java:221)

    Write in thread 1 holding locks Monitor@280705438, Monitor@1733568579, Monitor@801740080, Monitor@1041146493
      > at org.apache.lucene.store.RAMFile.setLength(RAMFile.java:50)
        - locked Monitor@1041146493 at org.apache.lucene.store.RAMFile.setLength(RAMFile.java:n/a)
        at org.apache.lucene.store.RAMOutputStream.setFileLength(RAMOutputStream.java:141)
        at org.apache.lucene.store.RAMOutputStream.flush(RAMOutputStream.java:147)
        at org.apache.lucene.store.MockRAMOutputStream.flush(MockRAMOutputStream.java:55)
        at org.apache.lucene.store.RAMOutputStream.close(RAMOutputStream.java:83)
        at org.apache.lucene.store.MockRAMOutputStream.close(MockRAMOutputStream.java:43)
        at org.apache.lucene.index.FieldsWriter.close(FieldsWriter.java:144)
        at org.apache.lucene.index.StoredFieldsWriter.closeDocStore(StoredFieldsWriter.java:84)
        - locked Monitor@801740080 at org.apache.lucene.index.StoredFieldsWriter.closeDocStore(StoredFieldsWriter.java:n/a)
        at org.apache.lucene.index.DocFieldProcessor.closeDocStore(DocFieldProcessor.java:50)
        at org.apache.lucene.index.DocumentsWriter.closeDocStore(DocumentsWriter.java:426)
        at org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:627)
        - locked Monitor@1733568579 at org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:n/a)
        at org.apache.lucene.index.IndexWriter.doFlushInternal(IndexWriter.java:4374)
        at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:4264)
        - locked Monitor@280705438 at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:n/a)
        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:4255)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2546)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2500)
        at org.apache.lucene.index.Test2783.runTest(Test2783.java:157)
        at org.apache.lucene.index.Test2783.testAtomicUpdates(Test2783.java:209)
        at junit.framework.TestCase.runTest(TestCase.java:176)
        at junit.framework.TestCase.runBare(TestCase.java:141)
        at org.apache.lucene.util.LuceneTestCase293.runBare(LuceneTestCase293.java:234)
        at junit.framework.TestResult$1.protect(TestResult.java:122)
        at junit.framework.TestResult.runProtected(TestResult.java:142)
        at junit.framework.TestResult.run(TestResult.java:125)
        at junit.framework.TestCase.run(TestCase.java:129)
        at junit.framework.TestSuite.runTest(TestSuite.java:255)
        at junit.framework.TestSuite.run(TestSuite.java:250)
        at junit.textui.TestRunner.doRun(TestRunner.java:116)
        at junit.textui.TestRunner.start(TestRunner.java:183)
        at junit.textui.TestRunner.main(TestRunner.java:137)
    Thread 1 is the main thread


Data race on field org.apache.lucene.index.ConcurrentMergeScheduler.writer:
    Read in thread 31
      > at org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:235)
        at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:291)
    Thread 31 created by thread 1
        at org.apache.lucene.index.ConcurrentMergeScheduler.merge(ConcurrentMergeScheduler.java:221)

    Write in thread 1
      > at org.apache.lucene.index.ConcurrentMergeScheduler.merge(ConcurrentMergeScheduler.java:155)
        at org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:3070)
        at org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:3065)
        at org.apache.lucene.index.IndexWriter.maybeMerge(IndexWriter.java:3061)
        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:4256)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2546)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2500)
        at org.apache.lucene.index.Test2783.runTest(Test2783.java:157)
        at org.apache.lucene.index.Test2783.testAtomicUpdates(Test2783.java:209)
        at junit.framework.TestCase.runTest(TestCase.java:176)
        at junit.framework.TestCase.runBare(TestCase.java:141)
        at org.apache.lucene.util.LuceneTestCase293.runBare(LuceneTestCase293.java:234)
        at junit.framework.TestResult$1.protect(TestResult.java:122)
        at junit.framework.TestResult.runProtected(TestResult.java:142)
        at junit.framework.TestResult.run(TestResult.java:125)
        at junit.framework.TestCase.run(TestCase.java:129)
        at junit.framework.TestSuite.runTest(TestSuite.java:255)
        at junit.framework.TestSuite.run(TestSuite.java:250)
        at junit.textui.TestRunner.doRun(TestRunner.java:116)
        at junit.textui.TestRunner.start(TestRunner.java:183)
        at junit.textui.TestRunner.main(TestRunner.java:137)
    Thread 1 is the main thread


