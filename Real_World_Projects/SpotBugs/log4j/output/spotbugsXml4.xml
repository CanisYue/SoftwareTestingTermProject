<?xml version="1.0" encoding="utf-8"?>
<BugCollection sequence='0' release='' analysisTimestamp='1670460589604' version='4.7.0' timestamp='1670457664926'><Project projectName='Apache Log4j Flume Bridge'><Jar>/home/ecelrc/students/ztang/22f/projects/apache-log4j-2.19.0-src/log4j-flume-ng/target/classes</Jar><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/logging/log4j/log4j-api/2.19.0/log4j-api-2.19.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/logging/log4j/log4j-core/2.19.0/log4j-core-2.19.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/sleepycat/je/18.3.12/je-18.3.12.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/slf4j/slf4j-api/1.7.36/slf4j-api-1.7.36.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-logging/commons-logging/1.2/commons-logging-1.2.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-sdk/1.10.1/flume-ng-sdk-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/avro/avro/1.11.0/avro-1.11.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/fasterxml/jackson/core/jackson-core/2.13.4/jackson-core-2.13.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/fasterxml/jackson/core/jackson-databind/2.13.4/jackson-databind-2.13.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/fasterxml/jackson/core/jackson-annotations/2.13.4/jackson-annotations-2.13.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/avro/avro-ipc-netty/1.11.0/avro-ipc-netty-1.11.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/avro/avro-ipc/1.11.0/avro-ipc-1.11.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/velocity/velocity-engine-core/2.3/velocity-engine-core-2.3.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/github/luben/zstd-jni/1.5.0-4/zstd-jni-1.5.0-4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/httpcomponents/httpclient/4.5.10/httpclient-4.5.10.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/jcraft/jzlib/1.1.3/jzlib-1.1.3.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-lang/commons-lang/2.6/commons-lang-2.6.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-core/1.10.1/flume-ng-core-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-configuration/1.10.1/flume-ng-configuration-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-config-filter-api/1.10.1/flume-ng-config-filter-api-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-auth/1.10.1/flume-ng-auth-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/google/guava/guava/11.0.2/guava-11.0.2.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/google/code/findbugs/jsr305/1.3.9/jsr305-1.3.9.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-codec/commons-codec/1.15/commons-codec-1.15.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-cli/commons-cli/1.5.0/commons-cli-1.5.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/joda-time/joda-time/2.9.9/joda-time-2.9.9.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-servlet/9.4.41.v20210516/jetty-servlet-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-security/9.4.41.v20210516/jetty-security-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-util-ajax/9.4.41.v20210516/jetty-util-ajax-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-util/9.4.41.v20210516/jetty-util-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-server/9.4.41.v20210516/jetty-server-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/javax/servlet/javax.servlet-api/4.0.1/javax.servlet-api-4.0.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-http/9.4.41.v20210516/jetty-http-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-io/9.4.41.v20210516/jetty-io-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/eclipse/jetty/jetty-jmx/9.4.41.v20210516/jetty-jmx-9.4.41.v20210516.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/com/google/code/gson/gson/2.2.2/gson-2.2.2.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/mina/mina-core/2.1.5/mina-core-2.1.5.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-embedded-agent/1.10.1/flume-ng-embedded-agent-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-node/1.10.1/flume-ng-node-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-sinks/flume-hdfs-sink/1.10.1/flume-hdfs-sink-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-sinks/flume-irc-sink/1.10.1/flume-irc-sink-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/schwering/irclib/1.10/irclib-1.10.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-channels/flume-jdbc-channel/1.10.1/flume-jdbc-channel-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-dbcp/commons-dbcp/1.4/commons-dbcp-1.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/flume/flume-ng-channels/flume-spillable-memory-channel/1.10.1/flume-spillable-memory-channel-1.10.1.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/commons/commons-text/1.9/commons-text-1.9.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/commons/commons-lang3/3.12.0/commons-lang3-3.12.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/curator/curator-framework/5.1.0/curator-framework-5.1.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/curator/curator-client/5.1.0/curator-client-5.1.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/zookeeper/zookeeper/3.6.0/zookeeper-3.6.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/zookeeper/zookeeper-jute/3.6.0/zookeeper-jute-3.6.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-transport-native-epoll/4.1.45.Final/netty-transport-native-epoll-4.1.45.Final.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/apache/curator/curator-recipes/5.1.0/curator-recipes-5.1.0.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/org/xerial/snappy/snappy-java/1.1.8.4/snappy-java-1.1.8.4.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-buffer/4.1.80.Final/netty-buffer-4.1.80.Final.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-common/4.1.80.Final/netty-common-4.1.80.Final.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-handler/4.1.80.Final/netty-handler-4.1.80.Final.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-transport-native-unix-common/4.1.80.Final/netty-transport-native-unix-common-4.1.80.Final.jar</AuxClasspathEntry><AuxClasspathEntry>/misc/scratch/zttest/mvnrepo/io/netty/netty-transport/4.1.80.Final/netty-transport-4.1.80.Final.jar</AuxClasspathEntry><Plugin id='com.h3xstream.findsecbugs' enabled='true'></Plugin><SrcDir>/home/ecelrc/students/ztang/22f/projects/apache-log4j-2.19.0-src/log4j-flume-ng/src/main/java</SrcDir><WrkDir>/home/ecelrc/students/ztang/22f/projects/apache-log4j-2.19.0-src/log4j-flume-ng/target</WrkDir></Project><BugInstance instanceOccurrenceNum='0' instanceHash='66b7f6e294aa23ae89e171e4af3a0a86' cweid='353' rank='10' abbrev='CIPINT' category='SECURITY' priority='1' type='CIPHER_INTEGRITY' instanceOccurrenceMax='0'><ShortMessage>Cipher with no integrity</ShortMessage><LongMessage>The cipher does not provide data integrity</LongMessage><Class classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' primary='true'><SourceLine classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='66' end='248' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java'><Message>At FlumePersistentManager.java:[lines 66-248]</Message></SourceLine><Message>In class org.apache.logging.log4j.flume.appender.FlumePersistentManager</Message></Class><Method isStatic='false' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' signature='(Lorg/apache/flume/Event;)V' name='send' primary='true'><SourceLine endBytecode='724' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='175' end='208' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='0'></SourceLine><Message>In method org.apache.logging.log4j.flume.appender.FlumePersistentManager.send(Event)</Message></Method><SourceLine endBytecode='196' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='193' end='193' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='196' primary='true'><Message>At FlumePersistentManager.java:[line 193]</Message></SourceLine></BugInstance><BugInstance instanceOccurrenceNum='0' instanceHash='8c6200e9d1e0b80812f6907ebc2da020' cweid='327' rank='10' abbrev='SECECB' category='SECURITY' priority='1' type='ECB_MODE' instanceOccurrenceMax='0'><ShortMessage>ECB mode is insecure</ShortMessage><LongMessage>The cipher uses ECB mode, which provides poor confidentiality for encrypted data</LongMessage><Class classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' primary='true'><SourceLine classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='66' end='248' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java'><Message>At FlumePersistentManager.java:[lines 66-248]</Message></SourceLine><Message>In class org.apache.logging.log4j.flume.appender.FlumePersistentManager</Message></Class><Method isStatic='false' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' signature='(Lorg/apache/flume/Event;)V' name='send' primary='true'><SourceLine endBytecode='724' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='175' end='208' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='0'></SourceLine><Message>In method org.apache.logging.log4j.flume.appender.FlumePersistentManager.send(Event)</Message></Method><SourceLine endBytecode='196' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager' start='193' end='193' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='196' primary='true'><Message>At FlumePersistentManager.java:[line 193]</Message></SourceLine></BugInstance><BugInstance instanceOccurrenceNum='0' instanceHash='e055efcf0a64342ff11a398d188aabfa' cweid='353' rank='10' abbrev='CIPINT' category='SECURITY' priority='1' type='CIPHER_INTEGRITY' instanceOccurrenceMax='0'><ShortMessage>Cipher with no integrity</ShortMessage><LongMessage>The cipher does not provide data integrity</LongMessage><Class classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' primary='true'><SourceLine classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='485' end='814' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java'><Message>At FlumePersistentManager.java:[lines 485-814]</Message></SourceLine><Message>In class org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread</Message></Class><Method isStatic='false' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' signature='(Lcom/sleepycat/je/DatabaseEntry;)Lorg/apache/flume/event/SimpleEvent;' name='createEvent' primary='true'><SourceLine endBytecode='538' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='789' end='814' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='0'></SourceLine><Message>In method org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread.createEvent(DatabaseEntry)</Message></Method><SourceLine endBytecode='22' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='793' end='793' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='22' primary='true'><Message>At FlumePersistentManager.java:[line 793]</Message></SourceLine></BugInstance><BugInstance instanceOccurrenceNum='0' instanceHash='768a3c985471a72ec46ec205540a3113' cweid='327' rank='10' abbrev='SECECB' category='SECURITY' priority='1' type='ECB_MODE' instanceOccurrenceMax='0'><ShortMessage>ECB mode is insecure</ShortMessage><LongMessage>The cipher uses ECB mode, which provides poor confidentiality for encrypted data</LongMessage><Class classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' primary='true'><SourceLine classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='485' end='814' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java'><Message>At FlumePersistentManager.java:[lines 485-814]</Message></SourceLine><Message>In class org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread</Message></Class><Method isStatic='false' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' signature='(Lcom/sleepycat/je/DatabaseEntry;)Lorg/apache/flume/event/SimpleEvent;' name='createEvent' primary='true'><SourceLine endBytecode='538' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='789' end='814' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='0'></SourceLine><Message>In method org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread.createEvent(DatabaseEntry)</Message></Method><SourceLine endBytecode='22' classname='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread' start='793' end='793' sourcepath='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' sourcefile='FlumePersistentManager.java' startBytecode='22' primary='true'><Message>At FlumePersistentManager.java:[line 793]</Message></SourceLine></BugInstance><BugCategory category='SECURITY'><Description>Security</Description></BugCategory><BugPattern cweid='353' abbrev='CIPINT' category='SECURITY' type='CIPHER_INTEGRITY'><ShortDescription>Cipher with no integrity</ShortDescription><Details>
            
&lt;p&gt;
    The ciphertext produced is susceptible to alteration by an adversary. This mean that the cipher provides no way to detect that the
    data has been tampered with. If the ciphertext can be controlled by an attacker, it could be altered without detection.
&lt;/p&gt;
&lt;p&gt;
    The solution is to use a cipher that includes a Hash based Message Authentication Code (HMAC) to sign the data. Combining a HMAC function to the
    existing cipher is prone to error &lt;sup&gt;&lt;a href="https://moxie.org/blog/the-cryptographic-doom-principle/"&gt;[1]&lt;/a&gt;&lt;/sup&gt;. Specifically,
    it is always recommended that you be able to verify the HMAC first, and only if the data is unmodified, do you then perform any cryptographic
    functions on the data.
&lt;/p&gt;
&lt;p&gt;The following modes are vulnerable because they don't provide a HMAC:&lt;br/&gt;
    - CBC&lt;br/&gt;
    - OFB&lt;br/&gt;
    - CTR&lt;br/&gt;
    - ECB&lt;br/&gt;&lt;br/&gt;
    The following snippets code are some examples of vulnerable code.&lt;br/&gt;&lt;br/&gt;
    &lt;b&gt;Code at risk:&lt;/b&gt;&lt;br/&gt;
    &lt;i&gt;AES in CBC mode&lt;/i&gt;&lt;br/&gt;

    &lt;pre&gt;Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);&lt;/pre&gt;
    &lt;br/&gt;
    &lt;i&gt;Triple DES with ECB mode&lt;/i&gt;&lt;br/&gt;

&lt;pre&gt;Cipher c = Cipher.getInstance("DESede/ECB/PKCS5Padding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);&lt;/pre&gt;
&lt;/p&gt;
&lt;p&gt;
    &lt;b&gt;Solution:&lt;/b&gt;
    &lt;pre&gt;Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);&lt;/pre&gt;
&lt;/p&gt;
&lt;p&gt;
In the example solution above, the GCM mode introduces an HMAC into the resulting encrypted data, providing integrity of the result.
&lt;/p&gt;
&lt;br/&gt;
&lt;p&gt;
    &lt;b&gt;References&lt;/b&gt;&lt;br/&gt;
    &lt;a href="https://en.wikipedia.org/wiki/Authenticated_encryption"&gt;Wikipedia: Authenticated encryption&lt;/a&gt;&lt;br/&gt;
    &lt;a href="https://csrc.nist.gov/projects/block-cipher-techniques/bcm/modes-develoment#01"&gt;NIST: Authenticated Encryption Modes&lt;/a&gt;&lt;br/&gt;
    &lt;a href="https://moxie.org/blog/the-cryptographic-doom-principle/"&gt;Moxie Marlinspike's blog: The Cryptographic Doom Principle&lt;/a&gt;&lt;br/&gt;
    &lt;a href="https://cwe.mitre.org/data/definitions/353.html"&gt;CWE-353: Missing Support for Integrity Check&lt;/a&gt;
&lt;/p&gt;

        </Details></BugPattern><BugPattern cweid='327' abbrev='SECECB' category='SECURITY' type='ECB_MODE'><ShortDescription>ECB mode is insecure</ShortDescription><Details>
            
&lt;p&gt;An authentication cipher mode which provides better confidentiality of the encrypted data should be used instead of Electronic Code Book (ECB) mode,
which does not provide good confidentiality. Specifically, ECB mode produces the same output for the same input each time. So,
for example, if a user is sending a password, the encrypted value is the same each time. This allows an attacker to intercept
and replay the data.&lt;/p&gt;
&lt;p&gt;
To fix this, something like Galois/Counter Mode (GCM) should be used instead.
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;Code at risk:&lt;/b&gt;
    &lt;pre&gt;Cipher c = Cipher.getInstance("AES/ECB/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);&lt;/pre&gt;
&lt;/p&gt;
&lt;p&gt;
    &lt;b&gt;Solution:&lt;/b&gt;
    &lt;pre&gt;Cipher c = Cipher.getInstance("AES/GCM/NoPadding");
c.init(Cipher.ENCRYPT_MODE, k, iv);
byte[] cipherText = c.doFinal(plainText);&lt;/pre&gt;
&lt;/p&gt;
&lt;br/&gt;
&lt;p&gt;
&lt;b&gt;References&lt;/b&gt;&lt;br/&gt;
&lt;a href="https://en.wikipedia.org/wiki/Authenticated_encryption"&gt;Wikipedia: Authenticated encryption&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://csrc.nist.gov/projects/block-cipher-techniques/bcm/modes-develoment#01"&gt;NIST: Authenticated Encryption Modes&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29"&gt;Wikipedia: Block cipher modes of operation&lt;/a&gt;&lt;br/&gt;
&lt;a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final"&gt;NIST: Recommendation for Block Cipher Modes of Operation&lt;/a&gt;
&lt;/p&gt;

        </Details></BugPattern><BugCode abbrev='CIPINT'><Description>Cipher with no integrity</Description></BugCode><BugCode abbrev='SECECB'><Description>ECB Mode</Description></BugCode><Errors missingClasses='0' errors='0'></Errors><FindBugsSummary num_packages='1' total_classes='25' priority_1='4' total_size='1302' clock_seconds='12.96' referenced_classes='219' vm_version='25.352-b08' total_bugs='4' java_version='1.8.0_352' gc_seconds='1.10' alloc_mbytes='455.50' cpu_seconds='56.92' peak_mbytes='241.01' timestamp='Wed, 7 Dec 2022 18:01:04 -0600'><FileStats path='org/apache/logging/log4j/flume/appender/AbstractFlumeManager.java' size='5' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/Agent.java' size='28' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/BatchEvent.java' size='12' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumeAppender.java' size='145' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumeAvroManager.java' size='198' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumeEmbeddedManager.java' size='157' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumeEvent.java' size='143' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumeEventFactory.java' size='2' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/FlumePersistentManager.java' size='582' bugHash='42b6019caecf980460dcd90a4a0c14ad' bugCount='4'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/Log4jEventSource.java' size='29' bugCount='0'></FileStats><FileStats path='org/apache/logging/log4j/flume/appender/package-info.java' size='1' bugCount='0'></FileStats><PackageStats package='org.apache.logging.log4j.flume.appender' priority_1='4' total_bugs='4' total_size='1302' total_types='25'><ClassStats bugs='0' size='5' interface='false' sourceFile='AbstractFlumeManager.java' class='org.apache.logging.log4j.flume.appender.AbstractFlumeManager'></ClassStats><ClassStats bugs='0' size='28' interface='false' sourceFile='Agent.java' class='org.apache.logging.log4j.flume.appender.Agent'></ClassStats><ClassStats bugs='0' size='12' interface='false' sourceFile='BatchEvent.java' class='org.apache.logging.log4j.flume.appender.BatchEvent'></ClassStats><ClassStats bugs='0' size='128' interface='false' sourceFile='FlumeAppender.java' class='org.apache.logging.log4j.flume.appender.FlumeAppender'></ClassStats><ClassStats bugs='0' size='4' interface='false' sourceFile='FlumeAppender.java' class='org.apache.logging.log4j.flume.appender.FlumeAppender$1'></ClassStats><ClassStats bugs='0' size='13' interface='false' sourceFile='FlumeAppender.java' class='org.apache.logging.log4j.flume.appender.FlumeAppender$ManagerType'></ClassStats><ClassStats bugs='0' size='160' interface='false' sourceFile='FlumeAvroManager.java' class='org.apache.logging.log4j.flume.appender.FlumeAvroManager'></ClassStats><ClassStats bugs='0' size='1' interface='false' sourceFile='FlumeAvroManager.java' class='org.apache.logging.log4j.flume.appender.FlumeAvroManager$1'></ClassStats><ClassStats bugs='0' size='11' interface='false' sourceFile='FlumeAvroManager.java' class='org.apache.logging.log4j.flume.appender.FlumeAvroManager$AvroManagerFactory'></ClassStats><ClassStats bugs='0' size='26' interface='false' sourceFile='FlumeAvroManager.java' class='org.apache.logging.log4j.flume.appender.FlumeAvroManager$FactoryData'></ClassStats><ClassStats bugs='0' size='62' interface='false' sourceFile='FlumeEmbeddedManager.java' class='org.apache.logging.log4j.flume.appender.FlumeEmbeddedManager'></ClassStats><ClassStats bugs='0' size='1' interface='false' sourceFile='FlumeEmbeddedManager.java' class='org.apache.logging.log4j.flume.appender.FlumeEmbeddedManager$1'></ClassStats><ClassStats bugs='0' size='20' interface='false' sourceFile='FlumeEmbeddedManager.java' class='org.apache.logging.log4j.flume.appender.FlumeEmbeddedManager$FactoryData'></ClassStats><ClassStats bugs='0' size='74' interface='false' sourceFile='FlumeEmbeddedManager.java' class='org.apache.logging.log4j.flume.appender.FlumeEmbeddedManager$FlumeManagerFactory'></ClassStats><ClassStats bugs='0' size='143' interface='false' sourceFile='FlumeEvent.java' class='org.apache.logging.log4j.flume.appender.FlumeEvent'></ClassStats><ClassStats bugs='0' size='2' interface='true' sourceFile='FlumeEventFactory.java' class='org.apache.logging.log4j.flume.appender.FlumeEventFactory'></ClassStats><ClassStats bugs='2' size='141' priority_1='2' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager'></ClassStats><ClassStats bugs='0' size='1' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$1'></ClassStats><ClassStats bugs='0' size='69' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$BDBManagerFactory'></ClassStats><ClassStats bugs='0' size='60' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$BDBWriter'></ClassStats><ClassStats bugs='0' size='35' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$FactoryData'></ClassStats><ClassStats bugs='0' size='18' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$Gate'></ClassStats><ClassStats bugs='2' size='258' priority_1='2' interface='false' sourceFile='FlumePersistentManager.java' class='org.apache.logging.log4j.flume.appender.FlumePersistentManager$WriterThread'></ClassStats><ClassStats bugs='0' size='29' interface='false' sourceFile='Log4jEventSource.java' class='org.apache.logging.log4j.flume.appender.Log4jEventSource'></ClassStats><ClassStats bugs='0' size='1' interface='true' sourceFile='package-info.java' class='org.apache.logging.log4j.flume.appender.package-info'></ClassStats></PackageStats><FindBugsProfile><ClassProfile avgMicrosecondsPerInvocation='900' totalMilliseconds='975' name='edu.umd.cs.findbugs.classfile.engine.ClassInfoAnalysisEngine' maxMicrosecondsPerInvocation='33994' standardDeviationMicrosecondsPerInvocation='2362' invocations='1083'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='452' totalMilliseconds='492' name='edu.umd.cs.findbugs.classfile.engine.ClassDataAnalysisEngine' maxMicrosecondsPerInvocation='138670' standardDeviationMicrosecondsPerInvocation='4254' invocations='1088'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2098' totalMilliseconds='459' name='edu.umd.cs.findbugs.detect.FieldItemSummary' maxMicrosecondsPerInvocation='25667' standardDeviationMicrosecondsPerInvocation='4407' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2539' totalMilliseconds='454' name='com.h3xstream.findsecbugs.taintanalysis.TaintDataflowEngine' maxMicrosecondsPerInvocation='46154' standardDeviationMicrosecondsPerInvocation='7149' invocations='179'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2019' totalMilliseconds='442' name='edu.umd.cs.findbugs.detect.FindNoSideEffectMethods' maxMicrosecondsPerInvocation='38659' standardDeviationMicrosecondsPerInvocation='4643' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='17686' totalMilliseconds='442' name='com.h3xstream.findsecbugs.NormalizationAfterValidationDetector' maxMicrosecondsPerInvocation='438712' standardDeviationMicrosecondsPerInvocation='85941' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2124' totalMilliseconds='380' name='edu.umd.cs.findbugs.classfile.engine.bcel.IsNullValueDataflowFactory' maxMicrosecondsPerInvocation='76903' standardDeviationMicrosecondsPerInvocation='7858' invocations='179'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2095' totalMilliseconds='373' name='edu.umd.cs.findbugs.classfile.engine.bcel.UnconditionalValueDerefDataflowFactory' maxMicrosecondsPerInvocation='78528' standardDeviationMicrosecondsPerInvocation='7933' invocations='178'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='741' totalMilliseconds='365' name='edu.umd.cs.findbugs.OpcodeStack$JumpInfoFactory' maxMicrosecondsPerInvocation='44104' standardDeviationMicrosecondsPerInvocation='2514' invocations='493'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1781' totalMilliseconds='326' name='edu.umd.cs.findbugs.classfile.engine.bcel.ValueNumberDataflowFactory' maxMicrosecondsPerInvocation='35366' standardDeviationMicrosecondsPerInvocation='4999' invocations='183'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1731' totalMilliseconds='316' name='edu.umd.cs.findbugs.classfile.engine.bcel.TypeDataflowFactory' maxMicrosecondsPerInvocation='40429' standardDeviationMicrosecondsPerInvocation='5397' invocations='183'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1744' totalMilliseconds='305' name='edu.umd.cs.findbugs.ba.npe.NullDerefAndRedundantComparisonFinder' maxMicrosecondsPerInvocation='34844' standardDeviationMicrosecondsPerInvocation='4776' invocations='175'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='777' totalMilliseconds='254' name='edu.umd.cs.findbugs.classfile.engine.bcel.JavaClassAnalysisEngine' maxMicrosecondsPerInvocation='23078' standardDeviationMicrosecondsPerInvocation='2374' invocations='327'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1050' totalMilliseconds='230' name='edu.umd.cs.findbugs.detect.FunctionsThatMightBeMistakenForProcedures' maxMicrosecondsPerInvocation='117675' standardDeviationMicrosecondsPerInvocation='8030' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1185' totalMilliseconds='214' name='edu.umd.cs.findbugs.classfile.engine.bcel.CFGFactory' maxMicrosecondsPerInvocation='28274' standardDeviationMicrosecondsPerInvocation='3291' invocations='181'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2460' totalMilliseconds='206' name='edu.umd.cs.findbugs.classfile.impl.ZipCodeBaseFactory' maxMicrosecondsPerInvocation='15355' standardDeviationMicrosecondsPerInvocation='3510' invocations='84'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='805' totalMilliseconds='176' name='edu.umd.cs.findbugs.detect.NoteDirectlyRelevantTypeQualifiers' maxMicrosecondsPerInvocation='16946' standardDeviationMicrosecondsPerInvocation='1990' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1677' totalMilliseconds='166' name='edu.umd.cs.findbugs.detect.FindRefComparison$SpecialTypeAnalysis' maxMicrosecondsPerInvocation='19451' standardDeviationMicrosecondsPerInvocation='3959' invocations='99'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='5763' totalMilliseconds='144' name='com.h3xstream.findsecbugs.groovy.GroovyShellDetector' maxMicrosecondsPerInvocation='140301' standardDeviationMicrosecondsPerInvocation='27463' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='5484' totalMilliseconds='137' name='edu.umd.cs.findbugs.detect.CheckRelaxingNullnessAnnotation' maxMicrosecondsPerInvocation='79848' standardDeviationMicrosecondsPerInvocation='15967' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='618' totalMilliseconds='135' name='edu.umd.cs.findbugs.detect.BuildObligationPolicyDatabase' maxMicrosecondsPerInvocation='31067' standardDeviationMicrosecondsPerInvocation='2385' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='668' totalMilliseconds='121' name='edu.umd.cs.findbugs.classfile.engine.bcel.MethodGenFactory' maxMicrosecondsPerInvocation='58743' standardDeviationMicrosecondsPerInvocation='4501' invocations='181'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='657' totalMilliseconds='117' name='edu.umd.cs.findbugs.classfile.engine.bcel.ConstantDataflowFactory' maxMicrosecondsPerInvocation='34129' standardDeviationMicrosecondsPerInvocation='3147' invocations='179'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='494' totalMilliseconds='108' name='edu.umd.cs.findbugs.detect.BuildStringPassthruGraph' maxMicrosecondsPerInvocation='9448' standardDeviationMicrosecondsPerInvocation='1252' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='4042' totalMilliseconds='101' name='edu.umd.cs.findbugs.detect.FindReturnRef' maxMicrosecondsPerInvocation='91894' standardDeviationMicrosecondsPerInvocation='17964' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='444' totalMilliseconds='97' name='edu.umd.cs.findbugs.detect.CalledMethods' maxMicrosecondsPerInvocation='10562' standardDeviationMicrosecondsPerInvocation='1255' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='3790' totalMilliseconds='94' name='com.h3xstream.findsecbugs.xml.TransformerFactoryDetector' maxMicrosecondsPerInvocation='90103' standardDeviationMicrosecondsPerInvocation='17620' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='90' totalMilliseconds='94' name='edu.umd.cs.findbugs.util.TopologicalSort' maxMicrosecondsPerInvocation='13591' standardDeviationMicrosecondsPerInvocation='514' invocations='1040'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='512' totalMilliseconds='92' name='edu.umd.cs.findbugs.classfile.engine.bcel.ValueRangeAnalysisFactory' maxMicrosecondsPerInvocation='32681' standardDeviationMicrosecondsPerInvocation='2980' invocations='181'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='3359' totalMilliseconds='83' name='edu.umd.cs.findbugs.detect.FindDeadLocalStores' maxMicrosecondsPerInvocation='19074' standardDeviationMicrosecondsPerInvocation='5592' invocations='25'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='1152' totalMilliseconds='83' name='edu.umd.cs.findbugs.ba.obl.ObligationAnalysis' maxMicrosecondsPerInvocation='28023' standardDeviationMicrosecondsPerInvocation='4196' invocations='72'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='74' totalMilliseconds='78' name='edu.umd.cs.findbugs.classfile.engine.asm.ClassReaderAnalysisEngine' maxMicrosecondsPerInvocation='47991' standardDeviationMicrosecondsPerInvocation='1543' invocations='1064'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='342' totalMilliseconds='74' name='edu.umd.cs.findbugs.detect.OverridingEqualsNotSymmetrical' maxMicrosecondsPerInvocation='9302' standardDeviationMicrosecondsPerInvocation='1036' invocations='219'></ClassProfile><ClassProfile avgMicrosecondsPerInvocation='2706' totalMilliseconds='67' name='edu.umd.cs.findbugs.detect.RuntimeExceptionCapture' maxMicrosecondsPerInvocation='25827' standardDeviationMicrosecondsPerInvocation='5535' invocations='25'></ClassProfile></FindBugsProfile></FindBugsSummary><ClassFeatures></ClassFeatures><History></History></BugCollection>